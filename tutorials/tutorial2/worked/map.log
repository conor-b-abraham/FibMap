
╔════════════════════════════════════════════════════╗
║ ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ ║
║ ░░███████╗██╗██████╗░███╗░░░███╗░█████╗░██████╗░░░ ║
║ ░░██╔════╝██║██╔══██╗████╗░████║██╔══██╗██╔══██╗░░ ║
║ ░░█████╗░░██║██████╦╝██╔████╔██║███████║██████╔╝░░ ║
║ ░░██╔══╝░░██║██╔══██╗██║╚██╔╝██║██╔══██║██╔═══╝░░░ ║
║ ░░██║░░░░░██║██████╦╝██║░╚═╝░██║██║░░██║██║░░░░░░░ ║
║ ░░╚═╝░░░░░╚═╝╚═════╝░╚═╝░░░░░╚═╝╚═╝░░╚═╝╚═╝░░░░░░░ ║
║ ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ ║
╚════════════════════════════════════════════════════╝
Calculates and visualizes key intrafibril interactions within an amyloid fibril.

Created by Conor B. Abraham in the Straub Group at Boston University

────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
PARAMETERS:
    - command: map
Input
    - trajectory_file: traj.xtc, traj.xtc
    - topology_file: top.tpr
    - checkpoint_file: map.cpt
    - hb_processed_file: processed_hydrogen_bonds.npy
    - hb_unprocessed_file: None
    - sb_processed_file: processed_salt_bridges.npy
    - sb_unprocessed_file: None
    - pi_processed_file: processed_pistacking_interactions.npy
    - pi_unprocessed_file: None
    - map_positions_file: map_positions.npz
Output
    - output_directory: .
    - verbose: True
    - nprocs: 1
    - nobackup: True
    - figure_file: Tutorial2_FibMap.png
    - showfig: True
    - output_log: map.log
    - output_cpt: map.cpt
Options
    - n_protofilaments: 2
    - omit_layers: 2
Figure Options
    - figure_width: 6.5
    - figure_height: 3.5
    - legend: True
    - figure_dpi: 300
    - transparent_background: False
    - numbered_residues: False
Regions
    - water_region: [(1, (22, 50))], [(2, (22, 50))]
    - zipper_region: [(1, (1, 32)), (2, (1, 32))]
Colors
    - acidic_color: firebrick
    - acidic_label_color: white
    - basic_color: steelblue
    - basic_label_color: white
    - polar_color: seagreen
    - polar_label_color: white
    - nonpolar_color: white
    - nonpolar_label_color: chain
    - backbone_color: black, dimgray
    - hbond_color_1: black
    - hbond_color_2: white
    - saltbridge_color_1: gold
    - saltbridge_color_2: orange
    - saltbridge_color_3: white
    - pistacking_color_1: gray
    - pistacking_color_2: white
    - water_color: powderblue
    - water_opacity: 0.5
    - zipper_color: tan
    - zipper_opacity: 0.5



SEGMENTS TO BE ANALYZED:
Protofilament 1: seg_4_P13 seg_6_P14 seg_8_P15 seg_10_P16 seg_12_P17 seg_14_P18 seg_16_P19 seg_18_P110
Protofilament 2: seg_5_P23 seg_7_P24 seg_9_P25 seg_11_P26 seg_13_P27 seg_15_P28 seg_17_P29 seg_19_P210

────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
CREATING FIBRIL MAP:
~ Residue label fontsize set to 6.0pt Arial
~ Residue positions retrieved from: map_positions.npz

────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
REGIONS:
  Hydrophobic Zipper: 1-SER1 --> 1-LYS33 --> 2-SER1 --> 2-LYS33 --> 1-SER1
       Water Channel: 1-ASP22 --> 1-VAL51 --> 1-ASP22
       Water Channel: 2-ASP22 --> 2-VAL51 --> 2-ASP22

────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
HYDROGEN BONDS:
                                 P(H-BOND)
     DONOR     ACCEPTOR   INTRALAYER  INTERLAYER
   1-SER1-SC   1-SER4-SC     0.111       0.615
    1-SER1-T  2-GLY30-BB     0.936       0.000
    1-SER1-T  2-ASP32-SC     0.944       0.802
   1-PHE2-BB   1-SER1-BB     0.000       0.757
   1-PHE3-BB   1-PHE2-BB     0.000       0.801
   1-LEU6-BB   1-PHE5-BB     0.000       0.929
   1-GLY7-BB   1-LEU6-BB     0.000       0.730
   1-GLU8-BB   1-GLY7-BB     0.000       0.646
   1-ALA9-BB   1-GLU8-BB     0.000       0.880
  1-TRP17-BB  1-MET16-BB     0.000       0.980
  1-ARG18-BB  1-TRP17-BB     0.000       0.826
  1-ARG18-SC  1-ASP15-SC     0.011       0.665
  1-ALA19-BB  1-ARG18-BB     0.000       0.802
  1-TYR20-BB  1-ALA19-BB     0.000       0.692
  1-SER21-BB  1-TYR20-BB     0.000       0.518
  1-SER21-SC  1-SER21-BB     0.000       0.607
  1-MET23-BB  1-ASP22-BB     0.000       0.926
  1-ARG24-BB  1-ASP22-SC     0.509       0.000
  1-ARG24-SC  1-ASP22-SC     1.000       0.000
  1-ARG24-SC  1-PRO48-BB     0.000       0.703
  1-GLU25-BB  1-ARG24-BB     0.000       0.506
  1-ASN27-BB  1-ALA26-BB     0.000       0.891
  1-ASN27-SC  1-ASN27-SC     0.000       0.844
  1-TYR28-SC  1-GLU25-BB     0.000       0.946
  1-ILE29-BB  1-TYR28-BB     0.000       0.967
  1-GLY30-BB  1-ILE29-BB     0.000       0.973
  1-SER31-BB  1-SER31-SC     0.000       0.932
  1-SER31-SC  1-ILE29-BB     0.538       0.000
  1-ASP32-BB  1-ASP32-SC     0.000       0.972
  1-LYS33-BB  1-ASP32-BB     0.000       0.864
  1-TYR34-BB  1-LYS33-BB     0.000       0.653
  1-HSD36-BB  1-PHE35-BB     0.000       0.615
  1-ALA37-BB  1-HSD36-BB     0.000       0.925
  1-ARG38-BB  1-ALA37-BB     0.000       0.921
  1-ARG38-SC  1-HSD36-SC     0.017       0.703
  1-ARG38-SC   2-GLU8-SC     0.000       0.552
  1-GLY39-BB  1-ARG38-BB     0.000       0.840
  1-ASN40-BB  1-ASN40-SC     0.000       0.829
  1-ASN40-SC  1-ALA37-BB     0.000       0.885
  1-ASN40-SC  1-ASN40-SC     0.000       0.720
  1-TYR41-BB  1-ASN40-BB     0.000       0.734
  1-ASP42-BB  1-TYR41-BB     0.000       0.740
  1-ALA43-BB  1-ASP42-BB     0.000       0.774
  1-LYS45-BB  1-ALA44-BB     0.000       0.778
  1-ARG46-BB  1-LYS45-BB     0.000       0.635
  1-ARG46-SC  1-GLU25-SC     0.000       0.913
  1-GLY47-BB  1-ARG46-BB     0.000       0.605
  1-GLY50-BB  1-ASP22-SC     0.000       0.724
  1-VAL51-BB  1-GLY50-BB     0.000       0.924
  1-TRP52-BB  1-VAL51-BB     0.000       0.762
  1-TRP52-SC  1-GLY49-BB     0.002       0.564
   2-SER1-SC   2-SER4-SC     0.134       0.533
    2-SER1-T  1-GLY30-BB     0.000       0.909
    2-SER1-T  1-ASP32-SC     0.000       0.973
   2-PHE2-BB   2-SER1-BB     0.000       0.699
   2-PHE3-BB   2-PHE2-BB     0.000       0.815
   2-LEU6-BB   2-PHE5-BB     0.000       0.946
   2-GLY7-BB   2-LEU6-BB     0.000       0.813
   2-GLU8-BB   2-GLY7-BB     0.000       0.604
   2-ALA9-BB   2-GLU8-BB     0.000       0.833
  2-TRP17-BB  2-MET16-BB     0.000       0.979
  2-ARG18-BB  2-TRP17-BB     0.000       0.856
  2-ARG18-SC  2-ASP15-BB     0.506       0.000
  2-ALA19-BB  2-ARG18-BB     0.000       0.859
  2-TYR20-BB  2-ALA19-BB     0.000       0.690
  2-SER21-BB  2-TYR20-BB     0.000       0.547
  2-SER21-SC  2-SER21-BB     0.000       0.590
  2-MET23-BB  2-ASP22-BB     0.000       0.929
  2-ARG24-SC  2-ASP22-SC     1.000       0.000
  2-ALA26-BB  2-MET23-BB     0.707       0.000
  2-ASN27-BB  2-ALA26-BB     0.000       0.949
  2-ASN27-SC  2-ASN27-SC     0.000       0.898
  2-TYR28-SC  2-GLU25-BB     0.000       0.935
  2-ILE29-BB  2-TYR28-BB     0.000       0.982
  2-GLY30-BB  2-ILE29-BB     0.000       0.973
  2-SER31-BB  2-SER31-SC     0.000       0.962
  2-SER31-SC  2-ILE29-BB     0.614       0.000
  2-ASP32-BB  2-ASP32-SC     0.000       0.973
  2-LYS33-BB  2-ASP32-BB     0.000       0.825
  2-LYS33-SC  2-GLU25-SC     0.663       0.455
  2-TYR34-BB  2-LYS33-BB     0.000       0.887
  2-HSD36-BB  2-PHE35-BB     0.000       0.813
  2-ALA37-BB  2-TYR34-BB     0.644       0.000
  2-ARG38-BB  2-ALA37-BB     0.000       0.902
  2-ARG38-SC   1-GLU8-SC     0.000       0.570
  2-GLY39-BB  2-ARG38-BB     0.000       0.791
  2-ASN40-BB  2-ASN40-SC     0.000       0.827
  2-ASN40-SC  2-ALA37-BB     0.000       0.883
  2-ASN40-SC  2-ASN40-SC     0.000       0.584
  2-TYR41-BB  2-ASN40-BB     0.000       0.830
  2-ASP42-BB  2-TYR41-BB     0.000       0.659
  2-ALA43-BB  2-ASP42-BB     0.000       0.793
  2-LYS45-BB  2-ALA44-BB     0.000       0.801
  2-ARG46-BB  2-LYS45-BB     0.000       0.765
  2-GLY47-BB  2-ARG46-BB     0.000       0.620
  2-GLY49-BB  2-PRO48-BB     0.000       0.638
  2-GLY50-BB  2-ASP22-SC     0.000       0.785
  2-VAL51-BB  2-GLY50-BB     0.000       0.874
  2-TRP52-BB  2-VAL51-BB     0.000       0.867
  2-ALA53-BB  2-TRP52-BB     0.000       0.822
   2-ALA54-T  2-ALA53-BB     0.001       0.791

────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
SALT BRIDGES:
                                 P(SALT BRIDGE)
     DONOR     ACCEPTOR   INTRALAYER  INTERLAYER
   1-GLU8-SC  2-ARG38-SC     0.000       0.567
  1-ASP15-SC  1-ARG18-SC     0.020       0.779
  1-ASP22-SC  1-ARG24-SC     1.000       0.883
  1-GLU25-SC  1-ARG46-SC     0.000       0.926
  1-ASP32-SC    2-SER1-T     0.000       1.000
   2-GLU8-SC  1-ARG38-SC     0.000       0.582
  2-ASP15-SC  2-ARG18-SC     0.137       0.566
  2-ASP22-SC  2-ARG24-SC     1.000       0.888
  2-GLU25-SC  2-LYS33-SC     0.886       0.597
  2-ASP32-SC    1-SER1-T     1.000       1.000

────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
PI STACKING INTERACTIONS:
                                Intralayer Probabilities               Interlayer Probabilities
   RESIDUE-A   RESIDUE-B    Total    T*     I*     S*     D*      Total    T*     I*     S*     D*
     1-PHE2        SAME     0.000  0.000  0.000  0.000  0.000     1.000  0.984  0.016  0.000  0.000
     1-PHE2      1-PHE3     0.845  0.953  0.047  0.000  0.000     0.001  0.000  1.000  0.000  0.000
     1-PHE3        SAME     0.000  0.000  0.000  0.000  0.000     1.000  0.997  0.003  0.000  0.000
     1-PHE5        SAME     0.000  0.000  0.000  0.000  0.000     1.000  0.986  0.014  0.000  0.000
     1-PHE5     1-TRP17     1.000  0.001  0.999  0.000  0.000     1.000  0.000  0.000  0.000  0.000
    1-PHE10        SAME     0.000  0.000  0.000  0.000  0.000     0.999  0.999  0.001  0.000  0.000
    1-PHE10     1-TRP17     0.267  1.000  0.000  0.000  0.000     1.000  0.000  0.000  0.000  0.000
    1-TRP17        SAME     0.000  0.000  0.000  0.000  0.000     1.000  1.000  0.000  0.000  0.000
    1-TYR20        SAME     0.000  0.000  0.000  0.000  0.000     1.000  0.997  0.003  0.000  0.000
    1-TYR28        SAME     0.000  0.000  0.000  0.000  0.000     1.000  0.993  0.007  0.000  0.000
    1-TYR34        SAME     0.000  0.000  0.000  0.000  0.000     1.000  0.720  0.280  0.000  0.000
    1-PHE35        SAME     0.000  0.000  0.000  0.000  0.000     1.000  0.996  0.004  0.000  0.000
    1-HSD36        SAME     0.000  0.000  0.000  0.000  0.000     1.000  0.973  0.027  0.000  0.000
    1-TYR41        SAME     0.000  0.000  0.000  0.000  0.000     0.997  0.896  0.104  0.000  0.000
    1-TRP52        SAME     0.000  0.000  0.000  0.000  0.000     0.922  0.983  0.017  0.000  0.000
     2-PHE2        SAME     0.000  0.000  0.000  0.000  0.000     1.000  0.996  0.004  0.000  0.000
     2-PHE2      2-PHE3     0.775  0.887  0.113  0.000  0.000     0.000  0.000  0.000  0.000  0.000
     2-PHE3        SAME     0.000  0.000  0.000  0.000  0.000     1.000  1.000  0.000  0.000  0.000
     2-PHE5        SAME     0.000  0.000  0.000  0.000  0.000     1.000  0.955  0.045  0.000  0.000
     2-PHE5     2-TRP17     0.995  0.010  0.990  0.000  0.000     1.000  0.000  0.000  0.000  0.000
    2-PHE10        SAME     0.000  0.000  0.000  0.000  0.000     1.000  1.000  0.000  0.000  0.000
    2-PHE10     2-TRP17     0.212  0.994  0.006  0.000  0.000     1.000  0.000  0.000  0.000  0.000
    2-TRP17        SAME     0.000  0.000  0.000  0.000  0.000     1.000  1.000  0.000  0.000  0.000
    2-TYR20        SAME     0.000  0.000  0.000  0.000  0.000     1.000  0.996  0.004  0.000  0.000
    2-TYR28        SAME     0.000  0.000  0.000  0.000  0.000     1.000  0.997  0.003  0.000  0.000
    2-TYR34        SAME     0.000  0.000  0.000  0.000  0.000     1.000  0.939  0.061  0.000  0.000
    2-PHE35        SAME     0.000  0.000  0.000  0.000  0.000     1.000  1.000  0.000  0.000  0.000
    2-HSD36        SAME     0.000  0.000  0.000  0.000  0.000     0.997  0.557  0.443  0.000  0.000
    2-TYR41        SAME     0.000  0.000  0.000  0.000  0.000     1.000  0.960  0.040  0.000  0.000
    2-TRP52        SAME     0.000  0.000  0.000  0.000  0.000     0.960  0.951  0.049  0.000  0.000
KEY (*)
The following probabilities are the probability of each kind of pi-stacking interaction when a given pi stacking interaction forms:
T: T-Shaped    I: Intermediate    S: Sandwich    D: Parallel Displaced

────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
COMPLETE:
~ Fibril Map saved to /home/conor/Research/programs/FibMap/tutorials/tutorial2/worked/Tutorial2_FibMap.png
